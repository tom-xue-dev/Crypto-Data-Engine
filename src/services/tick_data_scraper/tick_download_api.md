# Tick æ•°æ®ä¸‹è½½æ¥å£æ–‡æ¡£

æœ¬æ¥å£æ–‡æ¡£æè¿°äº†åŸºäº FastAPI + Celery æ„å»ºçš„ Tick æ•°æ®ä¸‹è½½ç³»ç»Ÿçš„ç”¨æˆ·æ¥å£ã€‚

---

## âœ… æ¥å£æ€»è§ˆ

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä½œç”¨ |
|----------|------|------|
| `/download-tick` | `POST` | æäº¤ tick ä¸‹è½½ä»»åŠ¡ï¼Œè¿”å› `task_id` |
| `/task-status/{task_id}` | `GET` | æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ä¸ç»“æœ |
| `/download-history` | `GET` | æŸ¥è¯¢å½“å‰ç”¨æˆ·å†å²ä¸‹è½½ä»»åŠ¡è®°å½•ï¼ˆåˆ†é¡µï¼‰ |

---

## ğŸ“¥ 1. POST `/download-tick`

### è¯·æ±‚å‚æ•°ï¼ˆJSONï¼‰:

```json
{
  "symbol": "BTCUSDT",
  "start_time": "2023-01-01T00:00:00",
  "end_time": "2023-01-02T00:00:00"
}
```

### å“åº”ç¤ºä¾‹:

```json
{
  "task_id": "2ec1e57a-3f48-4c96-91b0-4fcfe90d1df5",
  "status": "PENDING"
}
```

---

## ğŸ“¥ 2. GET `/task-status/{task_id}`

ç”¨äºæŸ¥è¯¢ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€åŠä¸‹è½½ç»“æœè·¯å¾„ã€‚

### å“åº”ç¤ºä¾‹ï¼ˆä»»åŠ¡æœªå®Œæˆï¼‰:

```json
{
  "task_id": "2ec1e57a-3f48-4c96-91b0-4fcfe90d1df5",
  "status": "PENDING"
}
```

### å“åº”ç¤ºä¾‹ï¼ˆä»»åŠ¡å®Œæˆï¼‰:

```json
{
  "task_id": "2ec1e57a-3f48-4c96-91b0-4fcfe90d1df5",
  "status": "SUCCESS",
  "result": {
    "file_path": "/data/btcusdt/20230101.csv"
  }
}
```

---

## ğŸ“¥ 3. GET `/download-history`

åˆ†é¡µæŸ¥è¯¢å½“å‰ç”¨æˆ·å†å²ä¸‹è½½è®°å½•ã€‚

### è¯·æ±‚å‚æ•°ï¼ˆQueryï¼‰:

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `page` | int | é¡µç ï¼Œé»˜è®¤ 1 |
| `page_size` | int | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ 20 |
| `symbol` | str | å¯é€‰ï¼Œç­›é€‰æŒ‡å®šäº¤æ˜“å¯¹ |

### å“åº”ç¤ºä¾‹:

```json
{
  "total": 132,
  "records": [
    {
      "task_id": "....",
      "symbol": "BTCUSDT",
      "created_at": "2023-01-01T00:00:00",
      "status": "SUCCESS",
      "file_path": "/data/btcusdt/20230101.csv",
      "duration": 10.3
    }
  ]
}
```

---
